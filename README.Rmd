---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ostRich

<!-- badges: start -->
![R package version](https://img.shields.io/github/r-package/v/EMSL-Computing/ostRich?label=R%20package)
<!-- badges: end -->

ostRich contains tools to operate on sets and is intended for preparing _a priori_ biomolecular/omics sets for enrichment analysis/gene set testing. Examples of biomolecular sets: Reactome pathways, Gene Ontology gene sets, phosphorylation sites grouped by their known kinases, and metabolites/lipids grouped by chemical subclasses (e.g., acyl carnitines, fatty acids). **In general, the functions in this package work with any named list of character vectors.**

Below is a overview of some core functions:

- `gmt_to_list`: Create a named list of sets from a GMT file.

- `incidence`: Compute a sparse incidence matrix with unique sets as rows and unique elements as columns. A value of 1 indicates that a particular element is a member of that set, while a value of 0 indicates that it is not.

- `similarity`: Compute the matrix of pairwise Jaccard or overlap similarity coefficients for all pairs of sets $A$ and $B$, where
  - $Jaccard(A, B) = \frac{|A \cap B|}{|A \cup B|}$
  - $Overlap(A, B) = \frac{|A \cap B|}{\min(|A|, |B|)}$

- `filter_sets`: Restrict sets to only those elements in a pre-determined background, if provided, and only keep those that pass minimum and maximum size thresholds.

- `cluster_sets`: hierarchical clustering of highly similar sets. Used to reduce redundancy prior to analysis.


## Installation

You can install the development version of ostRich like so:

``` r
if (!require("devtools", quietly = TRUE))
  install.packages("devtools")

devtools::install_github("EMSL-Computing/ostRich")
```

## Examples

```{r}
library(ostRich)

# Named list of sets
x <- list("Set1" = letters[1:5],
          "Set2" = letters[1:4], # subset of Set1
          "Set3" = letters[1:4], # aliased with Set2
          "Set4" = letters[1:3], # subset of Set1-Set3
          "Set5" = c("a", "a", NA), # duplicates and NA
          "Set6" = c("x", "y", "z"), # distinct elements
          "Set7" = letters[3:6]) # overlaps with Set1-Set5
x
```

```{r}
(imat <- incidence(x)) # incidence matrix

tcrossprod(imat) # pairwise intersection and set sizes

crossprod(imat) # occurrence of each element and pair of elements
```


```{r}
## Calculate matrices of pairwise Jaccard and overlap similarity coefficients
similarity(x) # Jaccard (default)

similarity(x, type = "overlap") # overlap
```

```{r}
## Cluster sets based on their similarity

# Cluster aliased sets (the empty brackets are required to display the table)
cluster_sets(x, cutoff = 1)[]

# Cluster subsets
cluster_sets(x, cutoff = 1, type = "overlap")[]
```
